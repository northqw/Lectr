<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta http-equiv="content-script-type" content="text/javascript">
    <meta http-equiv="content-style-type" content="text/css">
    <meta name="description" content="This is the online markdown editor with live preview.">
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self'; worker-src 'self' blob:; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none';"
    >

    <script>
      (function(){
        try {
          var BOOT_THEME_KEY = 'com.lectr_theme';
          var raw = localStorage.getItem(BOOT_THEME_KEY);
          var useDark = raw === 'dark';
          document.documentElement.setAttribute('data-theme', useDark ? 'dark' : 'light');

          var PREVIEW_CSS_LIGHT = 'css/github-markdown-light.css';
          var PREVIEW_CSS_DARK = 'css/github-markdown-dark_dimmed.css';
          var href = useDark ? PREVIEW_CSS_DARK : PREVIEW_CSS_LIGHT;

          var link = document.createElement('link');
          link.id = 'gh-markdown-link';
          link.rel = 'stylesheet';
          link.type = 'text/css';
          link.href = href;
          document.head.appendChild(link);
        } catch (e) {
          // ignore — app will correct theme after load
        }
      })();
    </script>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="icon" type="image/png" href="favicon.png">
    <script type="module" src="./src/main.js"></script>
    <title>Lectr</title>
  </head>

  <body>
    <button type="button" id="brand-button" aria-label="About Lectr">
      <span id="brand-wordmark">Lectr</span>
    </button>

    <header>
        <div id="header-content">
            <div id="format-toolbar" aria-label="Formatting">
              <button type="button" class="format-button" data-format="bold" title="Bold" aria-label="Bold">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7 4h7a4 4 0 0 1 0 8H7V4zm0 8h8a4 4 0 0 1 0 8H7v-8z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="italic" title="Italic" aria-label="Italic">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M14 4h6v2h-4l-4 12h4v2H6v-2h4l4-12h-4V4z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="strikethrough" title="Strikethrough" aria-label="Strikethrough">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 11h16v2H4v-2zm3-4a4.5 4.5 0 0 1 8.6-1.9l-1.8.8A2.5 2.5 0 0 0 9 7h6a4 4 0 0 1 0 8H9a4.4 4.4 0 0 1-3.9-2.3l1.8-1A2.4 2.4 0 0 0 9 13h6a2 2 0 0 0 0-4H7z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="code" title="Inline code" aria-label="Inline code">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M8.4 7.3L3.7 12l4.7 4.7 1.4-1.4L6.5 12l3.3-3.3-1.4-1.4zm7.2 0l-1.4 1.4 3.3 3.3-3.3 3.3 1.4 1.4 4.7-4.7-4.7-4.7zM13.4 4l-4 16h1.9l4-16h-1.9z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="h1" title="Heading 1" aria-label="Heading 1">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 5h2v6h6V5h2v14h-2v-6H5v6H3V5zm14 5h-2V8h4v11h-2v-9z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="h2" title="Heading 2" aria-label="Heading 2">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 5h2v6h6V5h2v14h-2v-6H5v6H3V5zm12.2 2.3A2.3 2.3 0 0 1 17.4 6h1.2A3.4 3.4 0 0 1 22 9.4c0 1.4-.7 2.3-1.8 3.1l-2.3 1.7c-.6.4-.9.8-1 1.2H22V18h-7.4v-1.3c0-1.8.7-3.2 2.4-4.4l1.9-1.4c.7-.5 1-.9 1-1.5a1.4 1.4 0 0 0-2.8 0v.4h-1.9v-.5z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="ul" title="Unordered list" aria-label="Unordered list">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 7a1.5 1.5 0 1 0 0 .01V7zm0 5a1.5 1.5 0 1 0 0 .01V12zm0 5a1.5 1.5 0 1 0 0 .01V17zM8 6h12v2H8V6zm0 5h12v2H8v-2zm0 5h12v2H8v-2z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="ol" title="Ordered list" aria-label="Ordered list">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h2v6H3V6zm1 8a2 2 0 0 1 2 2c0 .7-.3 1.3-1 1.8l-.7.5H6V20H3v-1.1l1.5-1.1c.4-.3.5-.5.5-.8a.9.9 0 0 0-1.8 0H2a2 2 0 0 1 2-2zm6-8h11v2H10V6zm0 5h11v2H10v-2zm0 5h11v2H10v-2z"/></svg>
              </button>
              <button type="button" class="format-button" data-format="quote" title="Quote" aria-label="Quote">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 6h16v2H4V6zm2 5h5v7H6v-7zm9 0h5v7h-5v-7zm-8 2v3h2v-3H7zm9 0v3h2v-3h-2z"/></svg>
              </button>
              <div class="inline-tool" id="link-tool">
                <button type="button" class="format-button" id="link-tool-button" data-format="link" title="Link" aria-label="Link" aria-haspopup="true" aria-expanded="false" aria-controls="link-popover">
                  <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M10.6 13.4a1 1 0 0 1 0-1.4l3.8-3.8a3 3 0 1 1 4.2 4.2l-2.3 2.3-1.4-1.4 2.3-2.3a1 1 0 1 0-1.4-1.4L12 13.4a1 1 0 0 1-1.4 0zM13.4 10.6a1 1 0 0 1 0 1.4l-3.8 3.8a3 3 0 1 1-4.2-4.2l2.3-2.3 1.4 1.4-2.3 2.3a1 1 0 1 0 1.4 1.4l3.8-3.8a1 1 0 0 1 1.4 0z"/></svg>
                </button>
                <div class="inline-popover" id="link-popover" role="dialog" aria-label="Insert link" aria-hidden="true">
                  <h3 id="link-popover-title">Insert link</h3>
                  <label class="table-field" for="link-text-input">
                    <span id="link-text-label">Link text</span>
                    <input id="link-text-input" type="text" maxlength="140" value="link text">
                  </label>
                  <label class="table-field" for="link-target-input">
                    <span id="link-target-label">File path or URL</span>
                    <div class="field-with-action">
                      <input id="link-target-input" type="text" maxlength="512" value="https://example.com">
                      <button type="button" id="link-browse-button" class="field-action-button">Browse...</button>
                    </div>
                  </label>
                  <label class="table-field" for="link-anchor-select">
                    <span id="link-anchor-label">Anchor</span>
                    <select id="link-anchor-select">
                      <option id="link-anchor-none-option" value="">No anchor</option>
                    </select>
                  </label>
                  <div class="table-actions">
                    <button type="button" id="link-insert-button">Insert link</button>
                    <button type="button" id="link-remove-button" class="table-action-secondary" hidden>Remove link</button>
                  </div>
                </div>
              </div>
              <div class="inline-tool" id="image-tool">
                <button type="button" class="format-button" id="image-tool-button" data-format="image" title="Image" aria-label="Image" aria-haspopup="true" aria-expanded="false" aria-controls="image-popover">
                  <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 4h18v16H3V4zm2 2v10h14V6H5zm3 8l3-4 2 3 2-2 3 3H8zm1-6a1.5 1.5 0 1 0 0 .01V8z"/></svg>
                </button>
                <div class="inline-popover" id="image-popover" role="dialog" aria-label="Insert image" aria-hidden="true">
                  <h3 id="image-popover-title">Insert image</h3>
                  <label class="table-field" for="image-alt-input">
                    <span id="image-alt-label">Alt text</span>
                    <input id="image-alt-input" type="text" maxlength="140" value="image">
                  </label>
                  <label class="table-field" for="image-src-input">
                    <span id="image-src-label">File path or URL</span>
                    <div class="field-with-action">
                      <input id="image-src-input" type="text" maxlength="512" value="image/example.png">
                      <button type="button" id="image-browse-button" class="field-action-button">Browse...</button>
                    </div>
                  </label>
                  <label class="table-field" for="image-title-input">
                    <span id="image-title-label">Title (optional)</span>
                    <input id="image-title-input" type="text" maxlength="140" value="">
                  </label>
                  <button type="button" id="image-insert-button">Insert image</button>
                </div>
              </div>
              <div class="table-tool" id="table-tool">
                <button type="button" class="format-button" id="table-tool-button" data-format="table" title="Table" aria-label="Table" aria-haspopup="true" aria-expanded="false" aria-controls="table-popover">
                  <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 4h18v16H3V4zm2 2v3h4V6H5zm6 0v3h8V6h-8zM5 11v3h4v-3H5zm6 0v3h8v-3h-8zM5 16v2h4v-2H5zm6 0v2h8v-2h-8z"/></svg>
                </button>
                <div class="table-popover" id="table-popover" role="dialog" aria-label="Table generator" aria-hidden="true">
                  <h3 id="table-popover-title">Insert table</h3>
                  <label class="table-field" for="table-columns-input">
                    <span id="table-columns-label">Columns</span>
                    <input id="table-columns-input" type="number" min="1" max="12" value="3">
                  </label>
                  <label class="table-field" for="table-rows-input">
                    <span id="table-rows-label">Rows</span>
                    <input id="table-rows-input" type="number" min="1" max="50" value="3">
                  </label>
                  <label class="table-field" for="table-align-select">
                    <span id="table-alignment-label">Alignment</span>
                    <select id="table-align-select">
                      <option id="table-alignment-left-option" value="left">Left</option>
                      <option id="table-alignment-center-option" value="center">Center</option>
                      <option id="table-alignment-right-option" value="right">Right</option>
                    </select>
                  </label>
                  <label class="table-check" for="table-header-checkbox">
                    <input id="table-header-checkbox" type="checkbox" checked>
                    <span id="table-header-label">Include header row</span>
                  </label>
                  <div class="table-actions">
                    <button type="button" id="table-insert-button">Insert table</button>
                  </div>
                </div>
              </div>
              <div class="inline-tool" id="note-tool">
                <button type="button" class="format-button" id="note-tool-button" data-format="note" title="Term note" aria-label="Term note" aria-haspopup="true" aria-expanded="false" aria-controls="note-popover">
                  <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M5 3h11l4 4v14H5V3zm2 2v14h11V8h-4V4H7zm2 5h7v2H9v-2zm0 4h7v2H9v-2z"/></svg>
                </button>
                <div class="inline-popover" id="note-popover" role="dialog" aria-label="Term archive" aria-hidden="true">
                  <h3 id="note-popover-title">Term archive</h3>
                  <label class="table-field note-search-field" for="note-search-input">
                    <span id="note-search-label">Search</span>
                    <input id="note-search-input" type="text" maxlength="160" value="">
                  </label>
                  <div class="note-entries-list" id="note-entries-list" role="listbox" aria-label="Archive entries"></div>
                  <button type="button" id="note-new-entry-button" class="table-action-secondary note-new-entry-button">Add note</button>
                  <div class="table-actions note-popover-actions">
                    <button type="button" id="note-bind-button" class="table-action-secondary">Bind to selection</button>
                    <button type="button" id="note-unbind-button" class="table-action-secondary" hidden>Remove binding</button>
                  </div>
                </div>
              </div>
            </div>
            <div id="app-menus">
              <div class="menu" data-menu="file">
                <button type="button" class="menu-trigger" aria-haspopup="true" aria-expanded="false" aria-controls="file-menu-panel">
                  <svg class="menu-trigger-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 7h16v2H4V7zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"/></svg>
                  <span id="file-menu-label">File</span>
                </button>
                <div class="menu-panel" id="file-menu-panel" role="menu">
                  <button type="button" id="open-file-button" class="menu-item" role="menuitem">Open...</button>
                  <button type="button" id="save-file-button" class="menu-item" role="menuitem">Save</button>
                  <button type="button" id="save-as-file-button" class="menu-item" role="menuitem">Save As...</button>
                  <button type="button" id="copy-button" class="menu-item" role="menuitem">Copy</button>
                  <button type="button" id="export-button" class="menu-item" role="menuitem">Export to PDF</button>
                  <button type="button" id="reset-button" class="menu-item danger" role="menuitem">Reset</button>
                </div>
              </div>

              <div class="menu" data-menu="settings">
                <button type="button" class="menu-trigger" aria-haspopup="true" aria-expanded="false" aria-controls="settings-menu-panel">
                  <svg class="menu-trigger-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 7h16v2H4V7zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"/></svg>
                  <span id="settings-menu-label">Settings</span>
                </button>
                <div class="menu-panel" id="settings-menu-panel" role="menu">
                  <label class="menu-item switch-item" role="menuitemcheckbox" for="theme-checkbox">
                    <span id="theme-label">Dark mode</span>
                    <span class="switch-control">
                      <input type="checkbox" id="theme-checkbox">
                      <span class="switch-slider" aria-hidden="true"></span>
                    </span>
                  </label>
                  <label class="menu-item switch-item" role="menuitemcheckbox" for="preview-edit-checkbox">
                    <span id="preview-edit-label">Edit preview</span>
                    <span class="switch-control">
                      <input type="checkbox" id="preview-edit-checkbox">
                      <span class="switch-slider" aria-hidden="true"></span>
                    </span>
                  </label>
                  <label class="menu-item select-item" for="language-select">
                    <span id="language-label">Language</span>
                    <select id="language-select">
                      <option value="en">English</option>
                      <option value="ru">Русский</option>
                    </select>
                  </label>
                  <label class="menu-item select-item" for="ui-zoom-select">
                    <span id="zoom-label">Scale</span>
                    <select id="ui-zoom-select">
                      <option value="80">80%</option>
                      <option value="90">90%</option>
                      <option value="100">100%</option>
                      <option value="110">110%</option>
                      <option value="120">120%</option>
                      <option value="130">130%</option>
                    </select>
                  </label>
                </div>
              </div>
            </div>
        </div>
    </header>

    <div id="tabs-bar" aria-label="Open files">
      <div id="tabs-list"></div>
      <button type="button" id="new-tab-button" aria-label="New tab" title="New tab">+</button>
    </div>

    <div id="container" class="split-container">

        <div id="edit" class="column editor-pane">
            <div id="editor-wrapper">
                <div id="editor"></div>
            </div>
        </div>

        <div id="split-divider" class="split-divider"></div>

        <div id="preview" class="column preview-pane">
            <div id="preview-wrapper">
                <div id="output" class="content markdown-body"></div>
            </div>
        </div>
    </div>

    <footer></footer>

    <div id="about-overlay" class="about-overlay" aria-hidden="true" hidden>
      <div class="about-modal" role="dialog" aria-modal="true" aria-labelledby="about-title">
        <button type="button" id="about-close-button" class="about-close-button" aria-label="Close">×</button>
        <div class="about-logo-wrap" aria-hidden="true">
          <span class="about-wordmark">Lectr</span>
        </div>
        <h2 id="about-title">About Lectr</h2>
        <dl class="about-info-list">
          <div class="about-info-row">
            <dt id="about-version-label">Version</dt>
            <dd id="about-version-value">v1.0.1</dd>
          </div>
          <div class="about-info-row">
            <dt id="about-developer-label">Developer</dt>
            <dd id="about-developer-value">northqw.</dd>
          </div>
          <div class="about-info-row">
            <dt id="about-repo-label">Repository</dt>
            <dd>
              <a id="about-repo-link" href="https://github.com/northqw/lectr" target="_blank" rel="noopener noreferrer">GitHub</a>
            </dd>
          </div>
          <div class="about-info-row">
            <dt id="about-license-label">License</dt>
            <dd id="about-license-value">MIT</dd>
          </div>
        </dl>
      </div>
    </div>

    <div id="note-editor-overlay" class="note-editor-overlay" aria-hidden="true" hidden>
      <div class="note-editor-modal" role="dialog" aria-modal="true" aria-labelledby="note-editor-modal-title">
        <button type="button" id="note-editor-close-button" class="note-editor-close-button" aria-label="Close">×</button>
        <h2 id="note-editor-modal-title">New archive note</h2>
        <label class="table-field" for="note-editor-title-input">
          <span id="note-editor-title-label">Term / title</span>
          <input id="note-editor-title-input" type="text" maxlength="160" value="">
        </label>
        <label class="table-field" for="note-editor-body-input">
          <span id="note-editor-body-label">Definition / note</span>
          <textarea id="note-editor-body-input" rows="6" maxlength="1200"></textarea>
        </label>
        <div class="note-editor-actions">
          <button type="button" id="note-editor-delete-button" class="table-action-secondary">Delete entry</button>
          <button type="button" id="note-editor-cancel-button" class="table-action-secondary">Cancel</button>
          <button type="button" id="note-editor-save-button">Save to archive</button>
        </div>
      </div>
    </div>

    <div id="onboarding-overlay" class="onboarding-overlay" aria-hidden="true" hidden>
      <div class="onboarding-modal" role="dialog" aria-modal="true" aria-labelledby="onboarding-title">
        <h2 id="onboarding-title">Set up Lectr</h2>
        <p id="onboarding-step-label">Step 1 of 3</p>

        <section class="onboarding-step active" data-onboarding-step="0">
          <h3 id="onboarding-language-title">Choose language</h3>
          <div class="onboarding-options">
            <button type="button" class="onboarding-option" data-onboarding-language="en">
              <span id="onboarding-language-en-label">English</span>
            </button>
            <button type="button" class="onboarding-option" data-onboarding-language="ru">
              <span id="onboarding-language-ru-label">Русский</span>
            </button>
          </div>
        </section>

        <section class="onboarding-step" data-onboarding-step="1">
          <h3 id="onboarding-mode-title">Choose mode</h3>
          <div class="onboarding-options">
            <button type="button" class="onboarding-option" data-onboarding-mode="advanced">
              <span class="onboarding-option-title" id="onboarding-mode-advanced-label">Advanced</span>
              <span class="onboarding-option-description" id="onboarding-mode-advanced-description">Raw markdown editor</span>
            </button>
            <button type="button" class="onboarding-option" data-onboarding-mode="simple">
              <span class="onboarding-option-title" id="onboarding-mode-simple-label">Simple (Experimental)</span>
              <span class="onboarding-option-description" id="onboarding-mode-simple-description">Edit directly in preview</span>
            </button>
          </div>
        </section>

        <section class="onboarding-step" data-onboarding-step="2">
          <h3 id="onboarding-theme-title">Choose theme</h3>
          <div class="onboarding-options">
            <button type="button" class="onboarding-option" data-onboarding-theme="light">
              <span id="onboarding-theme-light-label">Light</span>
            </button>
            <button type="button" class="onboarding-option" data-onboarding-theme="dark">
              <span id="onboarding-theme-dark-label">Dark</span>
            </button>
          </div>
        </section>

        <div class="onboarding-actions">
          <button type="button" id="onboarding-back-button" class="onboarding-action secondary">Back</button>
          <button type="button" id="onboarding-next-button" class="onboarding-action primary">Next</button>
        </div>
      </div>
    </div>
  </body>
</html>
